"use strict";(self.webpackChunkespresso=self.webpackChunkespresso||[]).push([[16],{7975:function(a,e,t){t.r(e),t.d(e,{assets:function(){return N},contentTitle:function(){return o},default:function(){return u},frontMatter:function(){return l},metadata:function(){return c},toc:function(){return k}});var n=t(7462),s=t(3366),m=(t(7294),t(3905)),p=t(814),r="&DOS\n  prefix='silicon',\n  outdir='./tmp/',\n  fildos='si_dos.dat',\n  emin=-9.0,\n  emax=16.0\n/\n",i=["components"],l={title:"Density of States calculation",sidebar_label:"DOS calculation"},o=void 0,c={unversionedId:"hands-on/dos",id:"hands-on/dos",title:"Density of States calculation",description:"Electronic density of states is an important property of a material.",source:"@site/docs/hands-on/dos.mdx",sourceDirName:"hands-on",slug:"/hands-on/dos",permalink:"/espresso/hands-on/dos",draft:!1,editUrl:"https://github.com/pranabdas/espresso/blob/main/docs/hands-on/dos.mdx",tags:[],version:"current",frontMatter:{title:"Density of States calculation",sidebar_label:"DOS calculation"},sidebar:"docs",previous:{title:"Structure optimization",permalink:"/espresso/hands-on/structure-optimization"},next:{title:"Bandstructure",permalink:"/espresso/hands-on/bands"}},N={},k=[],h={toc:k},d="wrapper";function u(a){var e=a.components,l=(0,s.Z)(a,i);return(0,m.kt)(d,(0,n.Z)({},h,l,{components:e,mdxType:"MDXLayout"}),(0,m.kt)("p",null,"Electronic density of states is an important property of a material."),(0,m.kt)("p",null,(0,m.kt)("span",{parentName:"p",className:"math math-inline"},(0,m.kt)("span",{parentName:"span",className:"katex"},(0,m.kt)("span",{parentName:"span",className:"katex-mathml"},(0,m.kt)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,m.kt)("semantics",{parentName:"math"},(0,m.kt)("mrow",{parentName:"semantics"},(0,m.kt)("mi",{parentName:"mrow"},"\u03c1"),(0,m.kt)("mo",{parentName:"mrow",stretchy:"false"},"("),(0,m.kt)("mi",{parentName:"mrow"},"E"),(0,m.kt)("mo",{parentName:"mrow",stretchy:"false"},")"),(0,m.kt)("mi",{parentName:"mrow"},"d"),(0,m.kt)("mi",{parentName:"mrow"},"E")),(0,m.kt)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"\\rho(E)dE")))),(0,m.kt)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,m.kt)("span",{parentName:"span",className:"base"},(0,m.kt)("span",{parentName:"span",className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,m.kt)("span",{parentName:"span",className:"mord mathnormal"},"\u03c1"),(0,m.kt)("span",{parentName:"span",className:"mopen"},"("),(0,m.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.05764em"}},"E"),(0,m.kt)("span",{parentName:"span",className:"mclose"},")"),(0,m.kt)("span",{parentName:"span",className:"mord mathnormal"},"d"),(0,m.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.05764em"}},"E")))))," = number of electronic states in the energy interval ",(0,m.kt)("span",{parentName:"p",className:"math math-inline"},(0,m.kt)("span",{parentName:"span",className:"katex"},(0,m.kt)("span",{parentName:"span",className:"katex-mathml"},(0,m.kt)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,m.kt)("semantics",{parentName:"math"},(0,m.kt)("mrow",{parentName:"semantics"},(0,m.kt)("mo",{parentName:"mrow",stretchy:"false"},"("),(0,m.kt)("mi",{parentName:"mrow"},"E"),(0,m.kt)("mo",{parentName:"mrow",separator:"true"},","),(0,m.kt)("mi",{parentName:"mrow"},"E"),(0,m.kt)("mo",{parentName:"mrow"},"+"),(0,m.kt)("mi",{parentName:"mrow"},"d"),(0,m.kt)("mi",{parentName:"mrow"},"E"),(0,m.kt)("mo",{parentName:"mrow",stretchy:"false"},")")),(0,m.kt)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"(E, E + dE)")))),(0,m.kt)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,m.kt)("span",{parentName:"span",className:"base"},(0,m.kt)("span",{parentName:"span",className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,m.kt)("span",{parentName:"span",className:"mopen"},"("),(0,m.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.05764em"}},"E"),(0,m.kt)("span",{parentName:"span",className:"mpunct"},","),(0,m.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.1667em"}}),(0,m.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.05764em"}},"E"),(0,m.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2222em"}}),(0,m.kt)("span",{parentName:"span",className:"mbin"},"+"),(0,m.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2222em"}})),(0,m.kt)("span",{parentName:"span",className:"base"},(0,m.kt)("span",{parentName:"span",className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,m.kt)("span",{parentName:"span",className:"mord mathnormal"},"d"),(0,m.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.05764em"}},"E"),(0,m.kt)("span",{parentName:"span",className:"mclose"},")")))))),(0,m.kt)("p",null,"Before we can run the Density of States (DOS) calculation, we need"),(0,m.kt)("ol",null,(0,m.kt)("li",{parentName:"ol"},(0,m.kt)("p",{parentName:"li"},"Perform fixed-ion self consistent filed (scf) calculation. In plane-wave\nbased DFT calculations the electronic density is expressed by functions of the\nform ",(0,m.kt)("span",{parentName:"p",className:"math math-inline"},(0,m.kt)("span",{parentName:"span",className:"katex"},(0,m.kt)("span",{parentName:"span",className:"katex-mathml"},(0,m.kt)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,m.kt)("semantics",{parentName:"math"},(0,m.kt)("mrow",{parentName:"semantics"},(0,m.kt)("mi",{parentName:"mrow"},"exp"),(0,m.kt)("mo",{parentName:"mrow"},"\u2061"),(0,m.kt)("mo",{parentName:"mrow",stretchy:"false"},"("),(0,m.kt)("mi",{parentName:"mrow"},"i"),(0,m.kt)("mtext",{parentName:"mrow",mathvariant:"bold"},"k"),(0,m.kt)("mo",{parentName:"mrow"},"\u22c5"),(0,m.kt)("mtext",{parentName:"mrow",mathvariant:"bold"},"r"),(0,m.kt)("mo",{parentName:"mrow",stretchy:"false"},")")),(0,m.kt)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"\\exp (i \\textbf{k} \\cdot \\textbf{r})")))),(0,m.kt)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,m.kt)("span",{parentName:"span",className:"base"},(0,m.kt)("span",{parentName:"span",className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,m.kt)("span",{parentName:"span",className:"mop"},"exp"),(0,m.kt)("span",{parentName:"span",className:"mopen"},"("),(0,m.kt)("span",{parentName:"span",className:"mord mathnormal"},"i"),(0,m.kt)("span",{parentName:"span",className:"mord text"},(0,m.kt)("span",{parentName:"span",className:"mord textbf"},"k")),(0,m.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2222em"}}),(0,m.kt)("span",{parentName:"span",className:"mbin"},"\u22c5"),(0,m.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2222em"}})),(0,m.kt)("span",{parentName:"span",className:"base"},(0,m.kt)("span",{parentName:"span",className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,m.kt)("span",{parentName:"span",className:"mord text"},(0,m.kt)("span",{parentName:"span",className:"mord textbf"},"r")),(0,m.kt)("span",{parentName:"span",className:"mclose"},")")))))," with energy given by\n",(0,m.kt)("span",{parentName:"p",className:"math math-inline"},(0,m.kt)("span",{parentName:"span",className:"katex"},(0,m.kt)("span",{parentName:"span",className:"katex-mathml"},(0,m.kt)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,m.kt)("semantics",{parentName:"math"},(0,m.kt)("mrow",{parentName:"semantics"},(0,m.kt)("mi",{parentName:"mrow"},"E"),(0,m.kt)("mo",{parentName:"mrow"},"="),(0,m.kt)("msup",{parentName:"mrow"},(0,m.kt)("mi",{parentName:"msup",mathvariant:"normal"},"\u210f"),(0,m.kt)("mn",{parentName:"msup"},"2")),(0,m.kt)("msup",{parentName:"mrow"},(0,m.kt)("mi",{parentName:"msup"},"k"),(0,m.kt)("mn",{parentName:"msup"},"2")),(0,m.kt)("mi",{parentName:"mrow",mathvariant:"normal"},"/"),(0,m.kt)("mn",{parentName:"mrow"},"2"),(0,m.kt)("mi",{parentName:"mrow"},"m")),(0,m.kt)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"E = \\hbar^2k^2/2m")))),(0,m.kt)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,m.kt)("span",{parentName:"span",className:"base"},(0,m.kt)("span",{parentName:"span",className:"strut",style:{height:"0.6833em"}}),(0,m.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.05764em"}},"E"),(0,m.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2778em"}}),(0,m.kt)("span",{parentName:"span",className:"mrel"},"="),(0,m.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2778em"}})),(0,m.kt)("span",{parentName:"span",className:"base"},(0,m.kt)("span",{parentName:"span",className:"strut",style:{height:"1.0641em",verticalAlign:"-0.25em"}}),(0,m.kt)("span",{parentName:"span",className:"mord"},(0,m.kt)("span",{parentName:"span",className:"mord"},"\u210f"),(0,m.kt)("span",{parentName:"span",className:"msupsub"},(0,m.kt)("span",{parentName:"span",className:"vlist-t"},(0,m.kt)("span",{parentName:"span",className:"vlist-r"},(0,m.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.8141em"}},(0,m.kt)("span",{parentName:"span",style:{top:"-3.063em",marginRight:"0.05em"}},(0,m.kt)("span",{parentName:"span",className:"pstrut",style:{height:"2.7em"}}),(0,m.kt)("span",{parentName:"span",className:"sizing reset-size6 size3 mtight"},(0,m.kt)("span",{parentName:"span",className:"mord mtight"},"2")))))))),(0,m.kt)("span",{parentName:"span",className:"mord"},(0,m.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.03148em"}},"k"),(0,m.kt)("span",{parentName:"span",className:"msupsub"},(0,m.kt)("span",{parentName:"span",className:"vlist-t"},(0,m.kt)("span",{parentName:"span",className:"vlist-r"},(0,m.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.8141em"}},(0,m.kt)("span",{parentName:"span",style:{top:"-3.063em",marginRight:"0.05em"}},(0,m.kt)("span",{parentName:"span",className:"pstrut",style:{height:"2.7em"}}),(0,m.kt)("span",{parentName:"span",className:"sizing reset-size6 size3 mtight"},(0,m.kt)("span",{parentName:"span",className:"mord mtight"},"2")))))))),(0,m.kt)("span",{parentName:"span",className:"mord"},"/2"),(0,m.kt)("span",{parentName:"span",className:"mord mathnormal"},"m"))))),".")),(0,m.kt)("li",{parentName:"ol"},(0,m.kt)("p",{parentName:"li"},"Perform non-self consistent field (nscf) calculation with denser k-point\ngrid. A large number of ",(0,m.kt)("span",{parentName:"p",className:"math math-inline"},(0,m.kt)("span",{parentName:"span",className:"katex"},(0,m.kt)("span",{parentName:"span",className:"katex-mathml"},(0,m.kt)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,m.kt)("semantics",{parentName:"math"},(0,m.kt)("mrow",{parentName:"semantics"},(0,m.kt)("mi",{parentName:"mrow"},"k")),(0,m.kt)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"k")))),(0,m.kt)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,m.kt)("span",{parentName:"span",className:"base"},(0,m.kt)("span",{parentName:"span",className:"strut",style:{height:"0.6944em"}}),(0,m.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.03148em"}},"k")))))," points are required DOS calculation, as the accuracy\nof DOS depends on the integration in ",(0,m.kt)("span",{parentName:"p",className:"math math-inline"},(0,m.kt)("span",{parentName:"span",className:"katex"},(0,m.kt)("span",{parentName:"span",className:"katex-mathml"},(0,m.kt)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,m.kt)("semantics",{parentName:"math"},(0,m.kt)("mrow",{parentName:"semantics"},(0,m.kt)("mi",{parentName:"mrow"},"k")),(0,m.kt)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"k")))),(0,m.kt)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,m.kt)("span",{parentName:"span",className:"base"},(0,m.kt)("span",{parentName:"span",className:"strut",style:{height:"0.6944em"}}),(0,m.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.03148em"}},"k")))))," space.")),(0,m.kt)("li",{parentName:"ol"},(0,m.kt)("p",{parentName:"li"},"Finally, the DOS can be determined by integrating the electron density in ",(0,m.kt)("span",{parentName:"p",className:"math math-inline"},(0,m.kt)("span",{parentName:"span",className:"katex"},(0,m.kt)("span",{parentName:"span",className:"katex-mathml"},(0,m.kt)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,m.kt)("semantics",{parentName:"math"},(0,m.kt)("mrow",{parentName:"semantics"},(0,m.kt)("mi",{parentName:"mrow"},"k")),(0,m.kt)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"k")))),(0,m.kt)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,m.kt)("span",{parentName:"span",className:"base"},(0,m.kt)("span",{parentName:"span",className:"strut",style:{height:"0.6944em"}}),(0,m.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.03148em"}},"k"))))),"\nspace."))),(0,m.kt)("p",null,"I have created a new input file (",(0,m.kt)("inlineCode",{parentName:"p"},"si_scf_dos.in"),") which is very much the same as\nour previous scf input file except some parameters are modified. You can find\nall the input files in my ",(0,m.kt)("a",{parentName:"p",href:"https://github.com/pranabdas/espresso/"},"GitHub repository"),". We used the lattice constant value that\nwe obtained from the relaxation calculation. We should not directly use the\nexperimental/real lattice constant value. Depending on the method and\npseudo-potential, it might result stress in the system. We have increased the\n",(0,m.kt)("inlineCode",{parentName:"p"},"ecutwfc")," to have better precision. We run the scf calculation:"),(0,m.kt)("pre",null,(0,m.kt)("code",{parentName:"pre",className:"language-bash"},"pw.x < si_scf_dos.in > si_scf_dos.out\n")),(0,m.kt)("p",null,"Next, we have prepared the input file for the ",(0,m.kt)("inlineCode",{parentName:"p"},"nscf")," calculation. Where is have\nadded ",(0,m.kt)("inlineCode",{parentName:"p"},"occupations")," in the ",(0,m.kt)("inlineCode",{parentName:"p"},"&system")," card as ",(0,m.kt)("inlineCode",{parentName:"p"},"tetrahedra")," (appropriate for DOS\ncalculation). We have increased the number of k-points to 12 \xd7 12 \xd7 12 with\nautomatic option. Also specify ",(0,m.kt)("inlineCode",{parentName:"p"},"nosym = .TRUE.")," to avoid generation of\nadditional k-points in low symmetry cases. ",(0,m.kt)("inlineCode",{parentName:"p"},"outdir")," and ",(0,m.kt)("inlineCode",{parentName:"p"},"prefix")," must be the\nsame as in the ",(0,m.kt)("inlineCode",{parentName:"p"},"scf")," step, some of the inputs and output are read from previous\nstep."),(0,m.kt)("pre",null,(0,m.kt)("code",{parentName:"pre",className:"language-bash"},"pw.x < si_nscf_dos.in > si_nscf_dos.out\n")),(0,m.kt)("p",null,"Now our final step is to calculate the density of states. The DOS input file as\nfollows:"),(0,m.kt)(p.Z,{language:"bash",title:"src/silicon/si_dos.in",showLineNumbers:!0,mdxType:"CodeBlock"},r),(0,m.kt)("p",null,"We run:"),(0,m.kt)("pre",null,(0,m.kt)("code",{parentName:"pre",className:"language-bash"},"dos.x < si_dos.in > si_dos.out\n")),(0,m.kt)("p",null,"The DOS data in the ",(0,m.kt)("inlineCode",{parentName:"p"},"si_dos.dat")," file that we specified in our input file. We\ncan plot the DOS:"),(0,m.kt)("pre",null,(0,m.kt)("code",{parentName:"pre",className:"language-python",metastring:'title="notebooks/silicon-dos.ipynb" showLineNumbers',title:'"notebooks/silicon-dos.ipynb"',showLineNumbers:!0},"import matplotlib.pyplot as plt\nfrom matplotlib import rcParamsDefault\nimport numpy as np\n%matplotlib inline\n\n# load data\nenergy, dos, idos = np.loadtxt('../src/silicon/si_dos.dat', unpack=True)\n\n# make plot\nplt.figure(figsize = (12, 6))\nplt.plot(energy, dos, linewidth=0.75, color='red')\nplt.yticks([])\nplt.xlabel('Energy (eV)')\nplt.ylabel('DOS')\nplt.axvline(x=6.642, linewidth=0.5, color='k', linestyle=(0, (8, 10)))\nplt.xlim(-6, 16)\nplt.ylim(0, )\nplt.fill_between(energy, 0, dos, where=(energy < 6.642), facecolor='red', alpha=0.25)\nplt.text(6, 1.7, 'Fermi energy', fontsize= med, rotation=90)\nplt.show()\n")),(0,m.kt)("picture",null,(0,m.kt)("source",{type:"image/webp",srcSet:t(4645).Z}),(0,m.kt)("img",{src:t(1280).Z,alt:"silicon-dos"})),(0,m.kt)("admonition",{title:"Important",type:"info"},(0,m.kt)("p",{parentName:"admonition"},"For a set of calculation, we must keep the ",(0,m.kt)("inlineCode",{parentName:"p"},"prefix")," same. For example, the\n",(0,m.kt)("strong",{parentName:"p"},"nscf")," or ",(0,m.kt)("strong",{parentName:"p"},"bands")," calculation uses the wavefunction calculated by the\n",(0,m.kt)("strong",{parentName:"p"},"scf")," calculation. When performing different calculations, for example you\nchange a parameter and want to see the changes, you must use different output\nfolder or unique ",(0,m.kt)("inlineCode",{parentName:"p"},"prefix")," for different calculations so that the outputs do not\nget mixed.")),(0,m.kt)("admonition",{type:"tip"},(0,m.kt)("p",{parentName:"admonition"},"Sometimes it is important to sample the ",(0,m.kt)("span",{parentName:"p",className:"math math-inline"},(0,m.kt)("span",{parentName:"span",className:"katex"},(0,m.kt)("span",{parentName:"span",className:"katex-mathml"},(0,m.kt)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,m.kt)("semantics",{parentName:"math"},(0,m.kt)("mrow",{parentName:"semantics"},(0,m.kt)("mi",{parentName:"mrow",mathvariant:"normal"},"\u0393")),(0,m.kt)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"\\Gamma")))),(0,m.kt)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,m.kt)("span",{parentName:"span",className:"base"},(0,m.kt)("span",{parentName:"span",className:"strut",style:{height:"0.6833em"}}),(0,m.kt)("span",{parentName:"span",className:"mord"},"\u0393")))))," point for DOS calculation\n(e.g., the conducting bands cross the Fermi surface only at ",(0,m.kt)("span",{parentName:"p",className:"math math-inline"},(0,m.kt)("span",{parentName:"span",className:"katex"},(0,m.kt)("span",{parentName:"span",className:"katex-mathml"},(0,m.kt)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,m.kt)("semantics",{parentName:"math"},(0,m.kt)("mrow",{parentName:"semantics"},(0,m.kt)("mi",{parentName:"mrow",mathvariant:"normal"},"\u0393")),(0,m.kt)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"\\Gamma")))),(0,m.kt)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,m.kt)("span",{parentName:"span",className:"base"},(0,m.kt)("span",{parentName:"span",className:"strut",style:{height:"0.6833em"}}),(0,m.kt)("span",{parentName:"span",className:"mord"},"\u0393")))))," point). In\nsuch cases, we need to use odd k-grid (e.g., 9\u27159\u27155).")))}u.isMDXComponent=!0},1280:function(a,e,t){e.Z=t.p+"assets/images/silicon-dos-9d095ddb8c71cd03ee572f2fe9f8356c.png"},4645:function(a,e,t){e.Z=t.p+"assets/images/silicon-dos-edf95503cd6527685b73ada318c5cf68.webp"}}]);